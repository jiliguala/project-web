'use strict';
const relative = require('relative');
const normalize = require('normalize-path');
/**
 * 插入less文件
 * @param  {Object} file     文件对象
 * @param  {Object} encoding 文件对象
 * @param  {Object} config   文件配置
 * @return {Array}           相关文件列表
 */
exports.importLess = function(file, encoding, config) {
    let content = file.contents.toString(encoding);
    const relativePath = normalize(relative(file.path, config.path));
    const PATH_RE = new RegExp(relativePath);
    // 查询是否有该引用,如果没有,则写入
    if(PATH_RE.test(content)) {
        return content;
    }
    content = `@import "${relativePath}";\n` + content;
    return content;
};